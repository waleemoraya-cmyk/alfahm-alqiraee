<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Ù…Ù†ØµØ© Ø§Ù„ÙÙ‡Ù… Ø§Ù„Ù‚Ø±Ø§Ø¦ÙŠ</title>
  <style>
    :root{
      --bg1:#0ea5e9; --bg2:#22c55e; --card:#ffffff; --text:#0f172a;
      --muted:#64748b; --primary:#2563eb; --good:#16a34a; --bad:#dc2626;
      --shadow:0 12px 35px rgba(0,0,0,.16); --radius:18px;
    }
    body{
      margin:0; font-family: Arial, sans-serif;
      background: linear-gradient(135deg,var(--bg1),var(--bg2));
      min-height:100vh; display:flex; align-items:center; justify-content:center;
      padding:18px; color:#fff;
    }
    .topname{position:fixed;top:10px;left:0;right:0;text-align:center;font-size:14px;opacity:.95;pointer-events:none;}
    .wrap{width:min(900px,100%);}
    .card{
      background:var(--card); color:var(--text);
      border-radius:var(--radius); box-shadow:var(--shadow);
      padding:18px;
    }
    h1{margin:0 0 8px; color:var(--primary); text-align:center;}
    .sub{margin:0 0 14px; text-align:center; color:var(--muted); font-size:14px;}
    .grid{display:grid; grid-template-columns: 1fr 1fr; gap:12px;}
    @media (max-width:800px){ .grid{grid-template-columns:1fr;} }

    .box{
      background:#f8fafc; border:1px solid #e5e7eb;
      border-radius:16px; padding:14px;
    }
    .row{display:flex; gap:10px; flex-wrap:wrap; align-items:center; justify-content:center;}
    input{
      padding:10px 12px; border-radius:12px; border:1px solid #e5e7eb;
      min-width:260px; font-size:14px;
      outline:none;
    }
    .btn{
      border:none; border-radius:12px; padding:10px 14px;
      cursor:pointer; font-weight:800; font-size:14px;
    }
    .btnPrimary{background:var(--primary); color:#fff;}
    .btnGhost{background:#eef2ff; color:#1e3a8a;}
    .story{
      background:#fff; border:1px dashed #cbd5e1; border-radius:14px;
      padding:14px; line-height:1.9; font-size:16px;
    }
    .q{margin:10px 0 8px; font-weight:900; text-align:center;}
    .answers{display:flex; gap:10px; justify-content:center; flex-wrap:wrap;}
    .answerBtn{
      background:var(--primary); color:#fff; border:none;
      border-radius:12px; padding:10px 14px;
      cursor:pointer; min-width:160px; font-weight:900;
    }
    .answerBtn.secondary{background:#0ea5e9;}
    .status{margin-top:10px; text-align:center; font-weight:900;}
    .status.good{color:var(--good);} .status.bad{color:var(--bad);}
    .kpis{display:flex; gap:10px; flex-wrap:wrap; justify-content:center; margin-top:10px;}
    .pill{
      background:#fff; border:1px solid #e5e7eb; border-radius:999px;
      padding:8px 12px; font-size:13px;
    }
    .muted{color:var(--muted); font-weight:800;}
    .hidden{display:none;}
  </style>
</head>
<body>

<div class="topname">Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù…Ø¹Ù„Ù…: ÙˆÙ„ÙŠØ¯ Ù…Ø±ÙŠØ¹</div>

<div class="wrap">
  <div class="card">
    <h1>ğŸ“š Ù…Ù†ØµØ© Ø§Ù„ÙÙ‡Ù… Ø§Ù„Ù‚Ø±Ø§Ø¦ÙŠ</h1>
    <p class="sub">Ø§ÙƒØªØ¨ Ø§Ø³Ù…Ùƒ Ø«Ù… Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±. Ø¹Ù†Ø¯ Ø§Ù„Ø¥Ù†Ù‡Ø§Ø¡ ØªÙØ±Ø³Ù„ Ø§Ù„Ù†ØªÙŠØ¬Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ Ù„Ù„Ù…Ø¹Ù„Ù… âœ…</p>

    <div class="grid">
      <!-- Ø§Ù„Ø¯Ø®ÙˆÙ„ -->
      <div class="box">
        <h3 style="margin:0 0 10px; text-align:center;">1) Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ø§Ù„Ø¨</h3>
        <div class="row">
          <input id="studentName" placeholder="Ø§ÙƒØªØ¨ Ø§Ø³Ù…Ùƒ Ø§Ù„Ø«Ù„Ø§Ø«ÙŠ Ù‡Ù†Ø§" />
          <button class="btn btnPrimary" id="startBtn">Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</button>
        </div>
        <p class="sub" style="margin-top:10px;">âš ï¸ Ø§ÙƒØªØ¨ Ø§Ø³Ù…Ùƒ ØµØ­ÙŠØ­Ù‹Ø§ (Ø³ÙŠØ¸Ù‡Ø± ÙÙŠ Ø³Ø¬Ù„ Ø§Ù„Ù†ØªØ§Ø¦Ø¬).</p>

        <div class="kpis">
          <div class="pill">Ø§Ù„Ø·Ø§Ù„Ø¨: <span class="muted" id="who">-</span></div>
          <div class="pill">Ø§Ù„ÙˆÙ‚Øª: <span class="muted" id="timer">0</span> Ø«</div>
        </div>
      </div>

      <!-- Ø§Ù„Ù†ØªØ§Ø¦Ø¬ + Ø¥Ø±Ø³Ø§Ù„ -->
      <div class="box">
        <h3 style="margin:0 0 10px; text-align:center;">2) Ø§Ù„Ù†ØªÙŠØ¬Ø©</h3>
        <div class="kpis">
          <div class="pill">Ø§Ù„Ù†Ù‚Ø§Ø·: <span class="muted" id="score">0</span></div>
          <div class="pill">Ø§Ù„Ø³Ø¤Ø§Ù„: <span class="muted" id="qNo">0</span>/<span class="muted" id="total">0</span></div>
          <div class="pill">Ø§Ù„Ù†Ø³Ø¨Ø©: <span class="muted" id="pct">0</span>%</div>
        </div>

        <div class="row" style="margin-top:12px;">
          <button class="btn btnGhost" id="resetBtn">Ø¥Ø¹Ø§Ø¯Ø©</button>
          <button class="btn btnPrimary" id="finishBtn" disabled>Ø¥Ù†Ù‡Ø§Ø¡ ÙˆØ¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù†ØªÙŠØ¬Ø©</button>
        </div>

        <div class="status" id="sendStatus"></div>
        <p class="sub" style="margin-top:10px;">Ø¨Ø¹Ø¯ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø³ÙŠØ¸Ù‡Ø± Ù„Ùƒ "ØªÙ… Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±" âœ…</p>
      </div>
    </div>

    <!-- Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± -->
    <div class="box" style="margin-top:12px;">
      <h3 style="margin:0 0 10px; text-align:center;">3) Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</h3>
      <div class="story" id="passage">Ø§Ø¶ØºØ· "Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±" Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù†Øµ.</div>
      <div class="q" id="question"></div>

      <div class="answers">
        <button class="answerBtn" id="a1" disabled>...</button>
        <button class="answerBtn secondary" id="a2" disabled>...</button>
      </div>

      <div class="status" id="status"></div>

      <div class="row" style="margin-top:12px;">
        <button class="btn btnPrimary" id="nextBtn" disabled>Ø§Ù„ØªØ§Ù„ÙŠ</button>
      </div>
    </div>

  </div>
</div>

<script>
  // âœ… Ø¶Ø¹ Ø±Ø§Ø¨Ø· Web App Ù‡Ù†Ø§:
  const WEB_APP_URL = "YOUR_WEB_APP_URL_HERE";

  // Ø¨Ù†Ùƒ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© (Ø²Ø¯Ù‡Ø§ ÙƒÙ…Ø§ ØªØ±ÙŠØ¯)
  const questions = [
    {
      passage: "Ø¹Ø§Ø¯ Ø®Ø§Ù„Ø¯ Ù…Ù† Ø§Ù„Ù…Ø¯Ø±Ø³Ø© Ù…ØªØ¹Ø¨Ù‹Ø§ØŒ ÙØ¬Ù„Ø³ Ù‚Ù„ÙŠÙ„Ù‹Ø§ Ø«Ù… Ø¨Ø¯Ø£ ÙŠØ±Ø§Ø¬Ø¹ Ø¯Ø±ÙˆØ³Ù‡. Ø¨Ø¹Ø¯ Ø°Ù„Ùƒ Ø¬Ù‡Ù‘Ø² Ø­Ù‚ÙŠØ¨ØªÙ‡ Ù„Ù„ÙŠÙˆÙ… Ø§Ù„ØªØ§Ù„ÙŠ Ù‚Ø¨Ù„ Ø£Ù† ÙŠÙ†Ø§Ù….",
      question: "Ù…Ø§ Ø§Ù„Ø°ÙŠ Ù†Ø³ØªÙ†ØªØ¬Ù‡ Ø¹Ù† Ø®Ø§Ù„Ø¯ØŸ",
      choices: ["Ù…Ù†Ø¸Ù… ÙˆÙŠØ³ØªØ¹Ø¯ Ù…Ø¨ÙƒØ±Ù‹Ø§", "Ù„Ø§ ÙŠØ­Ø¨ Ø§Ù„Ø¯Ø±Ø§Ø³Ø©"],
      correctIndex: 0
    },
    {
      passage: "ØªØ¹Ø§ÙˆÙ† Ø§Ù„Ø·Ù„Ø§Ø¨ ÙÙŠ ØªÙ†Ø¸ÙŠÙ Ø§Ù„ÙØµÙ„ Ø¨Ø¹Ø¯ Ø§Ù„Ø­ØµØ©ØŒ ÙØµØ§Ø± Ø§Ù„Ù…ÙƒØ§Ù† Ù…Ø±ØªØ¨Ù‹Ø§ ÙˆÙ†Ø¸ÙŠÙÙ‹Ø§ ÙˆØ´Ø¹Ø± Ø§Ù„Ø¬Ù…ÙŠØ¹ Ø¨Ø§Ù„Ø³Ø±ÙˆØ±.",
      question: "Ù…Ø§ Ø§Ù„ÙÙƒØ±Ø© Ø§Ù„Ø±Ø¦ÙŠØ³Ø© Ù„Ù„Ù†ØµØŸ",
      choices: ["Ø§Ù„ØªØ¹Ø§ÙˆÙ† ÙŠÙ†Ø¸Ù‘Ù… Ø§Ù„Ù…ÙƒØ§Ù†", "Ø§Ù„Ù„Ø¹Ø¨ ÙÙŠ Ø§Ù„ÙØµÙ„ Ù…Ù…ØªØ¹"],
      correctIndex: 0
    },
    {
      passage: "Ù‚Ø±Ø£ÙØª Ù„ÙŠØ§Ù† Ø¥Ø¹Ù„Ø§Ù†Ù‹Ø§ ÙŠÙ‚ÙˆÙ„: Ø§Ø´Ø±Ø¨ Ù‡Ø°Ø§ Ø§Ù„Ø¹ØµÙŠØ± ÙƒÙ„ ÙŠÙˆÙ… ÙˆØ³ØªØ­ØµÙ„ Ø¹Ù„Ù‰ Ø£Ø¹Ù„Ù‰ Ø§Ù„Ø¯Ø±Ø¬Ø§Øª Ø¯ÙˆÙ† Ø¯Ø±Ø§Ø³Ø©. ÙÙƒÙ‘Ø±Øª Ø«Ù… Ù‚Ø±Ø±Øª Ø£Ù† ØªØ¨Ø­Ø« Ø¹Ù† Ø¯Ù„ÙŠÙ„ Ù‚Ø¨Ù„ Ø£Ù† ØªØµØ¯Ù‚.",
      question: "Ù…Ø§ Ø§Ù„ØªØµØ±Ù Ø§Ù„Ø°ÙŠ ÙŠØ¯Ù„ Ø¹Ù„Ù‰ ØªÙÙƒÙŠØ± Ù†Ø§Ù‚Ø¯ØŸ",
      choices: ["Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø¯Ù„ÙŠÙ„ Ù‚Ø¨Ù„ Ø§Ù„ØªØµØ¯ÙŠÙ‚", "ØªØµØ¯ÙŠÙ‚ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† ÙÙˆØ±Ù‹Ø§"],
      correctIndex: 0
    },
    {
      passage: "Ø²Ø±Ø¹ ÙÙ‡Ø¯ Ø´ØªÙ„Ø©Ù‹ ØµØºÙŠØ±Ø© ÙˆØ³Ù‚Ø§Ù‡Ø§ ÙŠÙˆÙ…ÙŠÙ‹Ø§ØŒ ÙˆØ¨Ø¹Ø¯ Ù…Ø¯Ø©Ù ÙƒØ¨Ø±Øª ÙˆØµØ§Ø±Øª Ø´Ø¬Ø±Ø©Ù‹ Ø¬Ù…ÙŠÙ„Ø©.",
      question: "Ù…Ø§ Ø³Ø¨Ø¨ Ù†Ù…Ùˆ Ø§Ù„Ø´ØªÙ„Ø©ØŸ",
      choices: ["Ø³Ù‚Ø§Ù‡Ø§ ÙŠÙˆÙ…ÙŠÙ‹Ø§", "ØªØ±ÙƒÙ‡Ø§ Ø¯ÙˆÙ† Ø¹Ù†Ø§ÙŠØ©"],
      correctIndex: 0
    },
    {
      passage: "Ø¹Ù†Ø¯Ù…Ø§ Ø§Ø®ØªÙ„Ù ØµØ¯ÙŠÙ‚Ø§Ù†ØŒ Ø­Ø§ÙˆÙ„Ø§ Ø§Ù„ØªØ­Ø¯Ø« Ø¨Ù‡Ø¯ÙˆØ¡ Ø­ØªÙ‰ ÙˆØµÙ„Ø§ Ù„Ø­Ù„Ù‘Ù ÙŠØ±Ø¶ÙŠÙ‡Ù…Ø§.",
      question: "Ø£ÙØ¶Ù„ Ø·Ø±ÙŠÙ‚Ø© Ù„Ø­Ù„ Ø§Ù„Ø®Ù„Ø§Ù Ù‡ÙŠ:",
      choices: ["Ø§Ù„Ø­ÙˆØ§Ø± Ø§Ù„Ù‡Ø§Ø¯Ø¦", "Ø§Ù„ØµØ±Ø§Ø® ÙˆØ§Ù„ØºØ¶Ø¨"],
      correctIndex: 0
    }
  ];

  const $ = (id)=>document.getElementById(id);

  let state = {
    started:false,
    name:"",
    idx:0,
    score:0,
    answered:false,
    startTs:0,
    timerInt:null
  };

  function deviceInfo(){
    return navigator.userAgent || "";
  }

  function setStatus(el, msg, type){
    el.textContent = msg;
    el.className = "status" + (type ? (" " + type) : "");
  }

  function updateTop(){
    $("who").textContent = state.name || "-";
    $("score").textContent = state.score;
    $("qNo").textContent = state.started ? (state.idx + 1) : 0;
    $("total").textContent = questions.length;
    const pct = Math.round((state.score / questions.length) * 100);
    $("pct").textContent = isFinite(pct) ? pct : 0;
  }

  function renderQ(){
    const q = questions[state.idx];
    $("passage").textContent = q.passage;
    $("question").textContent = "â“ " + q.question;
    $("a1").textContent = q.choices[0];
    $("a2").textContent = q.choices[1];

    $("a1").disabled = false;
    $("a2").disabled = false;
    $("nextBtn").disabled = true;
    state.answered = false;
    setStatus($("status"), "", "");
    updateTop();

    // Ø²Ø± Ø¥Ù†Ù‡Ø§Ø¡ ÙŠØªÙØ¹Ù‘Ù„ ÙÙ‚Ø· Ø¨Ø¹Ø¯ Ø¢Ø®Ø± Ø³Ø¤Ø§Ù„
    $("finishBtn").disabled = state.idx !== questions.length - 1;
  }

  function answer(choice){
    if(!state.started || state.answered) return;
    state.answered = true;

    const q = questions[state.idx];
    const correct = choice === q.correctIndex;
    if(correct){
      state.score += 1;
      setStatus($("status"), "âœ… Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©!", "good");
    }else{
      setStatus($("status"), "âŒ Ø¥Ø¬Ø§Ø¨Ø© ØºÙŠØ± ØµØ­ÙŠØ­Ø©", "bad");
    }

    $("a1").disabled = true;
    $("a2").disabled = true;
    $("nextBtn").disabled = (state.idx >= questions.length - 1);

    // Ù„Ùˆ Ù…Ùˆ Ø¢Ø®Ø± Ø³Ø¤Ø§Ù„: ÙØ¹Ù‘Ù„ Ø§Ù„ØªØ§Ù„ÙŠ
    if(state.idx < questions.length - 1) $("nextBtn").disabled = false;

    // Ù„Ùˆ Ø¢Ø®Ø± Ø³Ø¤Ø§Ù„: ÙØ¹Ù‘Ù„ Ø¥Ù†Ù‡Ø§Ø¡
    if(state.idx === questions.length - 1) $("finishBtn").disabled = false;

    updateTop();
  }

  function startTimer(){
    clearInterval(state.timerInt);
    state.startTs = Date.now();
    state.timerInt = setInterval(()=>{
      const secs = Math.floor((Date.now() - state.startTs)/1000);
      $("timer").textContent = secs;
    }, 500);
  }

  function stopTimer(){
    clearInterval(state.timerInt);
    state.timerInt = null;
  }

  function start(){
    const name = $("studentName").value.trim();
    if(!name){
      alert("Ø§ÙƒØªØ¨ Ø§Ø³Ù…Ùƒ Ø£ÙˆÙ„Ù‹Ø§ âœ…");
      return;
    }
    state.started = true;
    state.name = name;
    state.idx = 0;
    state.score = 0;
    $("startBtn").disabled = true;
    $("studentName").disabled = true;

    $("nextBtn").disabled = false;
    $("finishBtn").disabled = true;

    startTimer();
    renderQ();
  }

  function next(){
    if(!state.started) return;
    if(state.idx < questions.length - 1){
      state.idx += 1;
      renderQ();
    }
  }

  async function finishAndSend(){
    if(!state.started) return;

    // Ù„Ø§Ø²Ù… ØªÙƒÙˆÙ† Ø®Ù„ØµØª Ø¢Ø®Ø± Ø³Ø¤Ø§Ù„ (Ø§Ø­ØªÙŠØ§Ø·)
    if(state.idx !== questions.length - 1 || !state.answered){
      alert("Ø£Ø¬Ø¨ Ø¹Ù† Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø£Ø®ÙŠØ± Ø£ÙˆÙ„Ù‹Ø§ âœ…");
      return;
    }

    stopTimer();
    const durationSeconds = Number($("timer").textContent || 0);

    setStatus($("sendStatus"), "â³ Ø¬Ø§Ø±Ù Ø§Ù„Ø¥Ø±Ø³Ø§Ù„...", "");

    const payload = {
      studentName: state.name,
      score: state.score,
      total: questions.length,
      durationSeconds,
      deviceInfo: deviceInfo()
    };

    try{
      const res = await fetch(WEB_APP_URL, {
        method: "POST",
        headers: {"Content-Type":"text/plain;charset=utf-8"},
        body: JSON.stringify(payload)
      });
      const out = await res.json().catch(()=>({ok:false}));

      if(out && out.ok){
        setStatus($("sendStatus"), "âœ… ØªÙ… Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± ÙˆØ¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø¨Ù†Ø¬Ø§Ø­!", "good");

        // Ù‚ÙÙ„ Ø§Ù„Ø£Ø²Ø±Ø§Ø±
        $("a1").disabled = true;
        $("a2").disabled = true;
        $("nextBtn").disabled = true;
        $("finishBtn").disabled = true;

      }else{
        setStatus($("sendStatus"), "âŒ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„. ØªØ£ÙƒØ¯ Ù…Ù† Ø±Ø§Ø¨Ø· Web App ÙˆØ¥Ø¹Ø¯Ø§Ø¯Ø§ØªÙ‡.", "bad");
      }
    }catch(e){
      setStatus($("sendStatus"), "âŒ Ø®Ø·Ø£ Ø§ØªØµØ§Ù„. Ø¬Ø±Ù‘Ø¨ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.", "bad");
    }
  }

  function resetAll(){
    stopTimer();
    state = {started:false,name:"",idx:0,score:0,answered:false,startTs:0,timerInt:null};

    $("studentName").value = "";
    $("studentName").disabled = false;
    $("startBtn").disabled = false;

    $("passage").textContent = "Ø§Ø¶ØºØ· \"Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±\" Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù†Øµ.";
    $("question").textContent = "";
    $("a1").textContent = "...";
    $("a2").textContent = "...";
    $("a1").disabled = true;
    $("a2").disabled = true;
    $("nextBtn").disabled = true;
    $("finishBtn").disabled = true;

    $("timer").textContent = "0";
    setStatus($("status"), "", "");
    setStatus($("sendStatus"), "", "");
    updateTop();
  }

  // Ø£Ø­Ø¯Ø§Ø«
  $("startBtn").addEventListener("click", start);
  $("nextBtn").addEventListener("click", next);
  $("finishBtn").addEventListener("click", finishAndSend);
  $("resetBtn").addEventListener("click", resetAll);

  $("a1").addEventListener("click", ()=>answer(0));
  $("a2").addEventListener("click", ()=>answer(1));

  // init
  updateTop();
</script>

</body>
</html>
